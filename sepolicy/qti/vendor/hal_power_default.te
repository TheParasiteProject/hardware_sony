allow hal_power_default vendor_latency_device:chr_file rw_file_perms;

rw_dir_file(hal_power_default, sysfs_dp)
rw_dir_file(hal_power_default, sysfs_tsp)

allow hal_power_default proc:file rw_file_perms;
allow hal_power_default vendor_latency_device:chr_file rw_file_perms;
get_prop(hal_power_default, vendor_freq_prop)
get_prop(hal_power_default, vendor_mpctl_prop)
allow hal_power_default vendor_mpctl_data_file:dir rw_dir_perms;
allow hal_power_default vendor_mpctl_data_file:file create_file_perms;
allow hal_power_default vendor_lm_data_file:dir rw_dir_perms;
allow hal_power_default vendor_lm_data_file:file create_file_perms;
allow hal_power_default vendor_sysfs_lib:file w_file_perms;
allow hal_power_default proc_meminfo:file r_file_perms;

allow hal_power_default {
     vendor_sysfs_mpctl
     vendor_sysfs_devfreq
     vendor_sysfs_mmc_host
     vendor_sysfs_scsi_host
     vendor_sysfs_kgsl
     vendor_sysfs_kgsl_proc
     vendor_sysfs_cpu_boost
     vendor_sysfs_msm_perf
     vendor_sysfs_memory
     vendor_sysfs_graphics
     vendor_sysfs_msm_power
     vendor_sysfs_battery_supply
     vendor_sysfs_process_reclaim
     vendor_sysfs_qfprom
}:dir r_dir_perms;

allow hal_power_default {
     vendor_sysfs_mpctl
     vendor_sysfs_cpu_boost
     vendor_sysfs_msm_perf
     vendor_sysfs_kgsl
     vendor_sysfs_cpu_boost
     vendor_sysfs_msm_perf
     vendor_sysfs_memory
     vendor_sysfs_graphics
     vendor_sysfs_scsi_host
     vendor_sysfs_devfreq
     vendor_sysfs_mmc_host
     vendor_sysfs_msm_power
     vendor_sysfs_battery_supply
     vendor_sysfs_process_reclaim
     vendor_sysfs_qfprom
     vendor_sysfs_kgsl_proc
     sysfs_dm
}:file rw_file_perms;

allow hal_power_default {
    vendor_sysfs_devfreq
    vendor_sysfs_mmc_host
    vendor_sysfs_scsi_host
    vendor_sysfs_kgsl
}:lnk_file r_file_perms;

# Allow hal_perf to set property
set_prop(hal_power_default, vendor_mpctl_prop)
set_prop(hal_power_default, vendor_wlc_public_prop)
# set_prop(hal_power_default, vendor_procomp_prop)

#Allow display driver access
allow hal_power_default graphics_device:chr_file rw_file_perms;

allow hal_power_default block_device:dir { open read search };
allow hal_power_default proc_diskstats:file { getattr open read };
